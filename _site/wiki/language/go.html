<!DOCTYPE HTML>
<html>
    <head>
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
        <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
        <title>go - Wiki</title>
        <meta name="keywords" content="simiki, wiki"/>
        <meta name="description" content=""/>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="container">
            
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#language">language</a>&nbsp;»&nbsp;go</div>
</div>
<div class="clearfix"></div>
<div id="title">go</div>
  <div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#syntax">Syntax</a><ul>
<li><a href="#reflect">Reflect</a></li>
</ul>
</li>
</ul>
</div>
<h1 id="syntax">Syntax</h1>
<h2 id="reflect">Reflect</h2>
<div class="hlcode"><pre><span></span><span class="o">//</span><span class="w"> </span><span class="n">StructToMap</span><span class="w"> </span><span class="n">converts</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="k">map</span><span class="o">[</span><span class="n">fieldName</span><span class="o">]=</span><span class="n">fieldValue</span><span class="p">.</span><span class="w"></span>
<span class="o">//</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">array</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">slice</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">fieldValue</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">length</span><span class="p">(</span><span class="n">don</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">care</span><span class="w"> </span><span class="k">value</span><span class="p">).</span><span class="w"></span>
<span class="o">//</span><span class="w"> </span><span class="k">Each</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">must</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">exported</span><span class="p">.</span><span class="w"></span>
<span class="n">func</span><span class="w"> </span><span class="n">StructToMap</span><span class="p">(</span><span class="ow">in</span><span class="w"> </span><span class="n">interface</span><span class="err">{}</span><span class="p">)</span><span class="w"> </span><span class="k">map</span><span class="o">[</span><span class="n">string</span><span class="o">]</span><span class="n">string</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">    </span><span class="n">ret</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">make</span><span class="p">(</span><span class="k">map</span><span class="o">[</span><span class="n">string</span><span class="o">]</span><span class="n">string</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">reflect</span><span class="p">.</span><span class="n">ValueOf</span><span class="p">(</span><span class="ow">in</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">typ</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">Type</span><span class="p">()</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">NumField</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">        </span><span class="n">f</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="p">.</span><span class="n">Field</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="nf">var</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">string</span><span class="w"></span>
<span class="w">        </span><span class="n">switch</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">Type</span><span class="p">().</span><span class="n">Kind</span><span class="p">()</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">reflect</span><span class="p">.</span><span class="n">Slice</span><span class="p">,</span><span class="w"> </span><span class="n">reflect</span><span class="p">.</span><span class="k">Array</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmt</span><span class="p">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="ss">&quot;%d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="nf">Len</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="k">default</span><span class="err">:</span><span class="w"></span>
<span class="w">            </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fmt</span><span class="p">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="ss">&quot;%v&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">Interface</span><span class="p">())</span><span class="w"></span>
<span class="w">        </span><span class="err">}</span><span class="w"></span>
<span class="w">        </span><span class="n">ret</span><span class="o">[</span><span class="n">typ.Field(i).Name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="w"></span>
<span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</pre></div>
</div>

        </div>
        <div id="footer">
            <span>
                Copyright © 2012-2019 MoreFreeze.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
            </span>
        </div>
        
    </body>
</html>